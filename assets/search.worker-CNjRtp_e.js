(function(){"use strict";function ae(E){if(Object.prototype.hasOwnProperty.call(E,"__esModule"))return E;var w=E.default;if(typeof w=="function"){var P=function M(){return this instanceof M?Reflect.construct(w,arguments,this.constructor):w.apply(this,arguments)};P.prototype=w.prototype}else P={};return Object.defineProperty(P,"__esModule",{value:!0}),Object.keys(E).forEach(function(M){var $=Object.getOwnPropertyDescriptor(E,M);Object.defineProperty(P,M,$.get?$:{enumerable:!0,get:function(){return E[M]}})}),P}var Rt={exports:{}},ge={},pe=Object.freeze({__proto__:null,default:ge}),de=ae(pe),$t;function me(){return $t||($t=1,function(E){var w;function P(t,e,i){const s=typeof i,n=typeof t;if(s!=="undefined"){if(n!=="undefined"){if(i){if(n==="function"&&s===n)return function(l){return t(i(l))};if(e=t.constructor,e===i.constructor){if(e===Array)return i.concat(t);if(e===Map){var r=new Map(i);for(var h of t)r.set(h[0],h[1]);return r}if(e===Set){h=new Set(i);for(r of t.values())h.add(r);return h}}}return t}return i}return n==="undefined"?e:t}function M(){return Object.create(null)}function $(t){return typeof t=="string"}function et(t){return typeof t=="object"}function we(t){const e=[];for(const i of t.keys())e.push(i);return e}function it(t,e){if($(e))t=t[e];else for(let i=0;t&&i<e.length;i++)t=t[e[i]];return t}function ye(t){let e=0;for(let i=0,s;i<t.length;i++)(s=t[i])&&e<s.length&&(e=s.length);return e}const xe=/[^\p{L}\p{N}]+/u,be=/(\d{3})/g,ve=/(\D)(\d{3})/g,ke=/(\d{3})(\D)/g,Nt=/[\u0300-\u036f]/g;function nt(t={}){if(!this||this.constructor!==nt)return new nt(...arguments);if(arguments.length)for(t=0;t<arguments.length;t++)this.assign(arguments[t]);else this.assign(t)}w=nt.prototype,w.assign=function(t){this.normalize=P(t.normalize,!0,this.normalize);let e=t.include,i=e||t.exclude||t.split,s;if(i||i===""){if(typeof i=="object"&&i.constructor!==RegExp){let n="";s=!e,e||(n+="\\p{Z}"),i.letter&&(n+="\\p{L}"),i.number&&(n+="\\p{N}",s=!!e),i.symbol&&(n+="\\p{S}"),i.punctuation&&(n+="\\p{P}"),i.control&&(n+="\\p{C}"),(i=i.char)&&(n+=typeof i=="object"?i.join(""):i);try{this.split=new RegExp("["+(e?"^":"")+n+"]+","u")}catch{this.split=/\s+/}}else this.split=i,s=i===!1||2>"a1a".split(i).length;this.numeric=P(t.numeric,s)}else{try{this.split=P(this.split,xe)}catch{this.split=/\s+/}this.numeric=P(t.numeric,P(this.numeric,!0))}if(this.prepare=P(t.prepare,null,this.prepare),this.finalize=P(t.finalize,null,this.finalize),i=t.filter,this.filter=typeof i=="function"?i:P(i&&new Set(i),null,this.filter),this.dedupe=P(t.dedupe,!0,this.dedupe),this.matcher=P((i=t.matcher)&&new Map(i),null,this.matcher),this.mapper=P((i=t.mapper)&&new Map(i),null,this.mapper),this.stemmer=P((i=t.stemmer)&&new Map(i),null,this.stemmer),this.replacer=P(t.replacer,null,this.replacer),this.minlength=P(t.minlength,1,this.minlength),this.maxlength=P(t.maxlength,1024,this.maxlength),this.rtl=P(t.rtl,!1,this.rtl),(this.cache=i=P(t.cache,!0,this.cache))&&(this.H=null,this.S=typeof i=="number"?i:2e5,this.B=new Map,this.G=new Map,this.L=this.K=128),this.h="",this.M=null,this.A="",this.N=null,this.matcher)for(const n of this.matcher.keys())this.h+=(this.h?"|":"")+n;if(this.stemmer)for(const n of this.stemmer.keys())this.A+=(this.A?"|":"")+n;return this},w.addStemmer=function(t,e){return this.stemmer||(this.stemmer=new Map),this.stemmer.set(t,e),this.A+=(this.A?"|":"")+t,this.N=null,this.cache&&W(this),this},w.addFilter=function(t){return typeof t=="function"?this.filter=t:(this.filter||(this.filter=new Set),this.filter.add(t)),this.cache&&W(this),this},w.addMapper=function(t,e){return typeof t=="object"?this.addReplacer(t,e):1<t.length?this.addMatcher(t,e):(this.mapper||(this.mapper=new Map),this.mapper.set(t,e),this.cache&&W(this),this)},w.addMatcher=function(t,e){return typeof t=="object"?this.addReplacer(t,e):2>t.length&&(this.dedupe||this.mapper)?this.addMapper(t,e):(this.matcher||(this.matcher=new Map),this.matcher.set(t,e),this.h+=(this.h?"|":"")+t,this.M=null,this.cache&&W(this),this)},w.addReplacer=function(t,e){return typeof t=="string"?this.addMatcher(t,e):(this.replacer||(this.replacer=[]),this.replacer.push(t,e),this.cache&&W(this),this)},w.encode=function(t,e){if(this.cache&&t.length<=this.K)if(this.H){if(this.B.has(t))return this.B.get(t)}else this.H=setTimeout(W,50,this);this.normalize&&(typeof this.normalize=="function"?t=this.normalize(t):t=Nt?t.normalize("NFKD").replace(Nt,"").toLowerCase():t.toLowerCase()),this.prepare&&(t=this.prepare(t)),this.numeric&&3<t.length&&(t=t.replace(ve,"$1 $2").replace(ke,"$1 $2").replace(be,"$1 "));const i=!(this.dedupe||this.mapper||this.filter||this.matcher||this.stemmer||this.replacer);let s=[],n=M(),r,h,l=this.split||this.split===""?t.split(this.split):[t];for(let c=0,f,u;c<l.length;c++)if((f=u=l[c])&&!(f.length<this.minlength||f.length>this.maxlength)){if(e){if(n[f])continue;n[f]=1}else{if(r===f)continue;r=f}if(i)s.push(f);else if(!this.filter||(typeof this.filter=="function"?this.filter(f):!this.filter.has(f))){if(this.cache&&f.length<=this.L)if(this.H){var o=this.G.get(f);if(o||o===""){o&&s.push(o);continue}}else this.H=setTimeout(W,50,this);if(this.stemmer){this.N||(this.N=new RegExp("(?!^)("+this.A+")$"));let p;for(;p!==f&&2<f.length;)p=f,f=f.replace(this.N,g=>this.stemmer.get(g))}if(f&&(this.mapper||this.dedupe&&1<f.length)){o="";for(let p=0,g="",d,m;p<f.length;p++)d=f.charAt(p),d===g&&this.dedupe||((m=this.mapper&&this.mapper.get(d))||m===""?m===g&&this.dedupe||!(g=m)||(o+=m):o+=g=d);f=o}if(this.matcher&&1<f.length&&(this.M||(this.M=new RegExp("("+this.h+")","g")),f=f.replace(this.M,p=>this.matcher.get(p))),f&&this.replacer)for(o=0;f&&o<this.replacer.length;o+=2)f=f.replace(this.replacer[o],this.replacer[o+1]);if(this.cache&&u.length<=this.L&&(this.G.set(u,f),this.G.size>this.S&&(this.G.clear(),this.L=this.L/1.1|0)),f){if(f!==u)if(e){if(n[f])continue;n[f]=1}else{if(h===f)continue;h=f}s.push(f)}}}return this.finalize&&(s=this.finalize(s)||s),this.cache&&t.length<=this.K&&(this.B.set(t,s),this.B.size>this.S&&(this.B.clear(),this.K=this.K/1.1|0)),s};function W(t){t.H=null,t.B.clear(),t.G.clear()}let Y,st;async function je(t){t=t.data;var e=t.task;const i=t.id;let s=t.args;switch(e){case"init":st=t.options||{},(e=t.factory)?(Function("return "+e)()(self),Y=new self.FlexSearch.Index(st),delete self.FlexSearch):Y=new J(st),postMessage({id:i});break;default:let n;e==="export"&&(s[1]?(s[0]=st.export,s[2]=0,s[3]=1):s=null),e==="import"?s[0]&&(t=await st.import.call(Y,s[0]),Y.import(s[0],t)):(n=s&&Y[e].apply(Y,s))&&n.then&&(n=await n),postMessage(e==="search"?{id:i,msg:n}:{id:i})}}function bt(t){rt.call(t,"add"),rt.call(t,"append"),rt.call(t,"search"),rt.call(t,"update"),rt.call(t,"remove")}let vt,Jt,ut;function Me(){vt=ut=0}function rt(t){this[t+"Async"]=function(){const e=arguments;var i=e[e.length-1];let s;if(typeof i=="function"&&(s=i,delete e[e.length-1]),vt?ut||(ut=Date.now()-Jt>=this.priority*this.priority*3):(vt=setTimeout(Me,0),Jt=Date.now()),ut){const r=this;return new Promise(h=>{setTimeout(function(){h(r[t+"Async"].apply(r,e))},0)})}const n=this[t].apply(this,e);return i=n.then?n:new Promise(r=>r(n)),s&&i.then(s),i}}let I=0;function ht(t={}){function e(h){function l(o){o=o.data||o;const c=o.id,f=c&&n.h[c];f&&(f(o.msg),delete n.h[c])}if(this.worker=h,this.h=M(),this.worker)return s?this.worker.on("message",l):this.worker.onmessage=l,t.config?new Promise(function(o){n.h[++I]=function(){o(n),1e9<I&&(I=0)},n.worker.postMessage({id:I,task:"init",factory:i,options:t})}):(this.worker.postMessage({task:"init",factory:i,options:t}),this.priority=t.priority||4,this)}if(!this||this.constructor!==ht)return new ht(t);let i=typeof self<"u"?self._factory:typeof window<"u"?window._factory:null;i&&(i=i.toString());const s=typeof window>"u",n=this,r=_e(i,s,t.worker);return r.then?r.then(function(h){return e.call(n,h)}):e.call(this,r)}G("add"),G("append"),G("search"),G("update"),G("remove"),G("clear"),G("export"),G("import"),bt(ht.prototype);function G(t){ht.prototype[t]=function(){const e=this,i=[].slice.call(arguments);var s=i[i.length-1];let n;return typeof s=="function"&&(n=s,i.pop()),s=new Promise(function(r){t==="export"&&typeof i[0]=="function"&&(i[0]=null),e.h[++I]=r,e.worker.postMessage({task:t,id:I,args:i})}),n?(s.then(n),this):s}}function _e(t,e,i){return e?new de.Worker(__dirname+"/worker/node.js"):t?new window.Worker(URL.createObjectURL(new Blob(["onmessage="+je.toString()],{type:"text/javascript"}))):new window.Worker(typeof i=="string"?i:self.location.href.replace("/worker.js","/worker/worker.js").replace("flexsearch.bundle.module.min.js","module/worker/worker.js"),{type:"module"})}function kt(t,e=0){let i=[],s=[];e&&(e=25e4/e*5e3|0);for(const n of t.entries())s.push(n),s.length===e&&(i.push(s),s=[]);return s.length&&i.push(s),i}function jt(t,e){e||(e=new Map);for(let i=0,s;i<t.length;i++)s=t[i],e.set(s[0],s[1]);return e}function qt(t,e=0){let i=[],s=[];e&&(e=25e4/e*1e3|0);for(const n of t.entries())s.push([n[0],kt(n[1])[0]]),s.length===e&&(i.push(s),s=[]);return s.length&&i.push(s),i}function Lt(t,e){e||(e=new Map);for(let i=0,s,n;i<t.length;i++)s=t[i],n=e.get(s[0]),e.set(s[0],jt(s[1],n));return e}function Kt(t){let e=[],i=[];for(const s of t.keys())i.push(s),i.length===25e4&&(e.push(i),i=[]);return i.length&&e.push(i),e}function Gt(t,e){e||(e=new Set);for(let i=0;i<t.length;i++)e.add(t[i]);return e}function at(t,e,i,s,n,r,h=0){const l=s&&s.constructor===Array;var o=l?s.shift():s;if(!o)return this.export(t,e,n,r+1);if((o=t((e?e+".":"")+(h+1)+"."+i,JSON.stringify(o)))&&o.then){const c=this;return o.then(function(){return at.call(c,t,e,i,l?s:null,n,r,h+1)})}return at.call(this,t,e,i,l?s:null,n,r,h+1)}function Ht(t,e){let i="";for(const s of t.entries()){t=s[0];const n=s[1];let r="";for(let h=0,l;h<n.length;h++){l=n[h]||[""];let o="";for(let c=0;c<l.length;c++)o+=(o?",":"")+(e==="string"?'"'+l[c]+'"':l[c]);o="["+o+"]",r+=(r?",":"")+o}r='["'+t+'",['+r+"]]",i+=(i?",":"")+r}return i}function Tt(t,e,i,s){let n=[];for(let r=0,h;r<t.index.length;r++)if(h=t.index[r],e>=h.length)e-=h.length;else{e=h[s?"splice":"slice"](e,i);const l=e.length;if(l&&(n=n.length?n.concat(e):e,i-=l,s&&(t.length-=l),!i))break;e=0}return n}function V(t){if(!this||this.constructor!==V)return new V(t);this.index=t?[t]:[],this.length=t?t.length:0;const e=this;return new Proxy([],{get(i,s){if(s==="length")return e.length;if(s==="push")return function(n){e.index[e.index.length-1].push(n),e.length++};if(s==="pop")return function(){if(e.length)return e.length--,e.index[e.index.length-1].pop()};if(s==="indexOf")return function(n){let r=0;for(let h=0,l,o;h<e.index.length;h++){if(l=e.index[h],o=l.indexOf(n),0<=o)return r+o;r+=l.length}return-1};if(s==="includes")return function(n){for(let r=0;r<e.index.length;r++)if(e.index[r].includes(n))return!0;return!1};if(s==="slice")return function(n,r){return Tt(e,n||0,r||e.length,!1)};if(s==="splice")return function(n,r){return Tt(e,n||0,r||e.length,!0)};if(s==="constructor")return Array;if(typeof s!="symbol")return(i=e.index[s/2**31|0])&&i[s]},set(i,s,n){return i=s/2**31|0,(e.index[i]||(e.index[i]=[]))[s]=n,e.length++,!0}})}V.prototype.clear=function(){this.index.length=0},V.prototype.destroy=function(){this.proxy=this.index=null},V.prototype.push=function(){};function L(t=8){if(!this||this.constructor!==L)return new L(t);this.index=M(),this.h=[],this.size=0,32<t?(this.B=Et,this.A=BigInt(t)):(this.B=Ut,this.A=t)}L.prototype.get=function(t){const e=this.index[this.B(t)];return e&&e.get(t)},L.prototype.set=function(t,e){var i=this.B(t);let s=this.index[i];s?(i=s.size,s.set(t,e),(i-=s.size)&&this.size++):(this.index[i]=s=new Map([[t,e]]),this.h.push(s),this.size++)};function N(t=8){if(!this||this.constructor!==N)return new N(t);this.index=M(),this.h=[],this.size=0,32<t?(this.B=Et,this.A=BigInt(t)):(this.B=Ut,this.A=t)}N.prototype.add=function(t){var e=this.B(t);let i=this.index[e];i?(e=i.size,i.add(t),(e-=i.size)&&this.size++):(this.index[e]=i=new Set([t]),this.h.push(i),this.size++)},w=L.prototype,w.has=N.prototype.has=function(t){const e=this.index[this.B(t)];return e&&e.has(t)},w.delete=N.prototype.delete=function(t){const e=this.index[this.B(t)];e&&e.delete(t)&&this.size--},w.clear=N.prototype.clear=function(){this.index=M(),this.h=[],this.size=0},w.values=N.prototype.values=function*(){for(let t=0;t<this.h.length;t++)for(let e of this.h[t].values())yield e},w.keys=N.prototype.keys=function*(){for(let t=0;t<this.h.length;t++)for(let e of this.h[t].keys())yield e},w.entries=N.prototype.entries=function*(){for(let t=0;t<this.h.length;t++)for(let e of this.h[t].entries())yield e};function Ut(t){let e=2**this.A-1;if(typeof t=="number")return t&e;let i=0,s=this.A+1;for(let n=0;n<t.length;n++)i=(i*s^t.charCodeAt(n))&e;return this.A===32?i+2**31:i}function Et(t){let e=BigInt(2)**this.A-BigInt(1);var i=typeof t;if(i==="bigint")return t&e;if(i==="number")return BigInt(t)&e;i=BigInt(0);let s=this.A+BigInt(1);for(let n=0;n<t.length;n++)i=(i*s^BigInt(t.charCodeAt(n)))&e;return i}tt.prototype.add=function(t,e,i){if(et(t)&&(e=t,t=it(e,this.key)),e&&(t||t===0)){if(!i&&this.reg.has(t))return this.update(t,e);for(let l=0,o;l<this.field.length;l++){o=this.F[l];var s=this.index.get(this.field[l]);if(typeof o=="function"){var n=o(e);n&&s.add(t,n,!1,!0)}else n=o.I,(!n||n(e))&&(o.constructor===String?o=[""+o]:$(o)&&(o=[o]),_t(e,o,this.J,0,s,t,o[0],i))}if(this.tag)for(s=0;s<this.D.length;s++){var r=this.D[s];n=this.tag.get(this.R[s]);let l=M();if(typeof r=="function"){if(r=r(e),!r)continue}else{var h=r.I;if(h&&!h(e))continue;r.constructor===String&&(r=""+r),r=it(e,r)}if(n&&r){$(r)&&(r=[r]);for(let o=0,c,f;o<r.length;o++)if(c=r[o],!l[c]&&(l[c]=1,(h=n.get(c))?f=h:n.set(c,f=[]),!i||!f.includes(t))){if(f.length===2**31-1){if(h=new V(f),this.fastupdate)for(let u of this.reg.values())u.includes(f)&&(u[u.indexOf(f)]=h);n.set(c,f=h)}f.push(t),this.fastupdate&&((h=this.reg.get(t))?h.push(f):this.reg.set(t,[f]))}}}if(this.store&&(!i||!this.store.has(t))){let l;if(this.C){l=M();for(let o=0,c;o<this.C.length;o++){if(c=this.C[o],(i=c.I)&&!i(e))continue;let f;if(typeof c=="function"){if(f=c(e),!f)continue;c=[c.V]}else if($(c)||c.constructor===String){l[c]=e[c];continue}Mt(e,l,c,0,c[0],f)}}this.store.set(t,l||e)}this.worker&&(this.fastupdate||this.reg.add(t))}return this};function Mt(t,e,i,s,n,r){if(t=t[n],s===i.length-1)e[n]=r||t;else if(t)if(t.constructor===Array)for(e=e[n]=Array(t.length),n=0;n<t.length;n++)Mt(t,e,i,s,n);else e=e[n]||(e[n]=M()),n=i[++s],Mt(t,e,i,s,n)}function _t(t,e,i,s,n,r,h,l){if(t=t[h])if(s===e.length-1){if(t.constructor===Array){if(i[s]){for(e=0;e<t.length;e++)n.add(r,t[e],!0,!0);return}t=t.join(" ")}n.add(r,t,l,!0)}else if(t.constructor===Array)for(h=0;h<t.length;h++)_t(t,e,i,s,n,r,h,l);else h=e[++s],_t(t,e,i,s,n,r,h,l);else n.db&&n.remove(r)}function Wt(t,e,i,s,n,r,h){const l=t.length;let o=[],c,f;c=M();for(let u=0,p,g,d,m;u<e;u++)for(let a=0;a<l;a++)if(d=t[a],u<d.length&&(p=d[u]))for(let x=0;x<p.length;x++){if(g=p[x],(f=c[g])?c[g]++:(f=0,c[g]=1),m=o[f]||(o[f]=[]),!h){let y=u+(a||!n?0:r||0);m=m[y]||(m[y]=[])}if(m.push(g),h&&i&&f===l-1&&m.length-s===i)return s?m.slice(s):m}if(t=o.length)if(n)o=1<o.length?Vt(o,i,s,h,r):(o=o[0]).length>i||s?o.slice(s,i+s):o;else{if(t<l)return[];if(o=o[t-1],i||s)if(h)(o.length>i||s)&&(o=o.slice(s,i+s));else{n=[];for(let u=0,p;u<o.length;u++)if(p=o[u],p.length>s)s-=p.length;else if((p.length>i||s)&&(p=p.slice(s,i+s),i-=p.length,s&&(s-=p.length)),n.push(p),!i)break;o=1<n.length?[].concat.apply([],n):n[0]}}return o}function Vt(t,e,i,s,n){const r=[],h=M();let l;var o=t.length;let c;if(s){for(n=o-1;0<=n;n--)if(c=(s=t[n])&&s.length){for(o=0;o<c;o++)if(l=s[o],!h[l]){if(h[l]=1,i)i--;else if(r.push(l),r.length===e)return r}}}else for(let f=o-1,u,p=0;0<=f;f--){u=t[f];for(let g=0;g<u.length;g++)if(c=(s=u[g])&&s.length){for(let d=0;d<c;d++)if(l=s[d],!h[l])if(h[l]=1,i)i--;else{let m=(g+(f<o-1&&n||0))/(f+1)|0;if((r[m]||(r[m]=[])).push(l),++p===e)return r}}}return r}function ze(t,e,i){const s=M(),n=[];for(let r=0,h;r<e.length;r++){h=e[r];for(let l=0;l<h.length;l++)s[h[l]]=1}if(i)for(let r=0,h;r<t.length;r++)h=t[r],s[h]&&(n.push(h),s[h]=0);else for(let r=0,h,l;r<t.result.length;r++)for(h=t.result[r],e=0;e<h.length;e++)l=h[e],s[l]&&((n[r]||(n[r]=[])).push(l),s[l]=0);return n}function zt(t,e,i,s){if(!t.length)return t;if(t.length===1)return t=t[0],t=i||t.length>e?e?t.slice(i,i+e):t.slice(i):t,s?H.call(this,t):t;let n=[];for(let r=0,h,l;r<t.length;r++)if((h=t[r])&&(l=h.length)){if(i){if(i>=l){i-=l;continue}i<l&&(h=e?h.slice(i,i+e):h.slice(i),l=h.length,i=0)}if(l>e&&(h=h.slice(0,e),l=e),!n.length&&l>=e)return s?H.call(this,h):h;if(n.push(h),e-=l,!e)break}return n=1<n.length?[].concat.apply([],n):n[0],s?H.call(this,n):n}function gt(t,e,i){var s=i[0];if(s.then)return Promise.all(i).then(function(f){return t[e].apply(t,f)});if(s[0]&&s[0].index)return t[e].apply(t,s);s=[];let n=[],r=0,h=0,l,o,c;for(let f=0,u;f<i.length;f++)if(u=i[f]){let p;if(u.constructor===A)p=u.result;else if(u.constructor===Array)p=u;else if(r=u.limit||0,h=u.offset||0,c=u.suggest,o=u.resolve,l=u.enrich&&o,u.index)u.resolve=!1,p=u.index.search(u).result,u.resolve=o;else if(u.and)p=t.and(u.and);else if(u.or)p=t.or(u.or);else if(u.xor)p=t.xor(u.xor);else if(u.not)p=t.not(u.not);else continue;if(p.then)n.push(p);else if(p.length)s[f]=p;else if(!c&&(e==="and"||e==="xor")){s=[];break}}return{O:s,P:n,limit:r,offset:h,enrich:l,resolve:o,suggest:c}}A.prototype.or=function(){const{O:t,P:e,limit:i,offset:s,enrich:n,resolve:r}=gt(this,"or",arguments);return Ft.call(this,t,e,i,s,n,r)};function Ft(t,e,i,s,n,r){if(e.length){const h=this;return Promise.all(e).then(function(l){t=[];for(let o=0,c;o<l.length;o++)(c=l[o]).length&&(t[o]=c);return Ft.call(h,t,[],i,s,n,r)})}return t.length&&(this.result.length&&t.push(this.result),2>t.length?this.result=t[0]:(this.result=Vt(t,i,s,!1,this.h),s=0)),r?this.resolve(i,s,n):this}A.prototype.and=function(){let t=this.result.length,e,i,s,n;if(!t){const r=arguments[0];r&&(t=!!r.suggest,n=r.resolve,e=r.limit,i=r.offset,s=r.enrich&&n)}if(t){const{O:r,P:h,limit:l,offset:o,enrich:c,resolve:f,suggest:u}=gt(this,"and",arguments);return Zt.call(this,r,h,l,o,c,f,u)}return n?this.resolve(e,i,s):this};function Zt(t,e,i,s,n,r,h){if(e.length){const l=this;return Promise.all(e).then(function(o){t=[];for(let c=0,f;c<o.length;c++)(f=o[c]).length&&(t[c]=f);return Zt.call(l,t,[],i,s,n,r,h)})}if(t.length)if(this.result.length&&t.unshift(this.result),2>t.length)this.result=t[0];else{if(e=ye(t))return this.result=Wt(t,e,i,s,h,this.h,r),r?n?H.call(this.index,this.result):this.result:this;this.result=[]}else h||(this.result=t);return r?this.resolve(i,s,n):this}A.prototype.xor=function(){const{O:t,P:e,limit:i,offset:s,enrich:n,resolve:r,suggest:h}=gt(this,"xor",arguments);return Qt.call(this,t,e,i,s,n,r,h)};function Qt(t,e,i,s,n,r,h){if(e.length){const l=this;return Promise.all(e).then(function(o){t=[];for(let c=0,f;c<o.length;c++)(f=o[c]).length&&(t[c]=f);return Qt.call(l,t,[],i,s,n,r,h)})}if(t.length)if(this.result.length&&t.unshift(this.result),2>t.length)this.result=t[0];else return this.result=Oe.call(this,t,i,s,r,this.h),r?n?H.call(this.index,this.result):this.result:this;else h||(this.result=t);return r?this.resolve(i,s,n):this}function Oe(t,e,i,s,n){const r=[],h=M();let l=0;for(let o=0,c;o<t.length;o++)if(c=t[o]){l<c.length&&(l=c.length);for(let f=0,u;f<c.length;f++)if(u=c[f])for(let p=0,g;p<u.length;p++)g=u[p],h[g]=h[g]?2:1}for(let o=0,c,f=0;o<l;o++)for(let u=0,p;u<t.length;u++)if((p=t[u])&&(c=p[o])){for(let g=0,d;g<c.length;g++)if(d=c[g],h[d]===1)if(i)i--;else if(s){if(r.push(d),r.length===e)return r}else{const m=o+(u?n:0);if(r[m]||(r[m]=[]),r[m].push(d),++f===e)return r}}return r}A.prototype.not=function(){const{O:t,P:e,limit:i,offset:s,enrich:n,resolve:r,suggest:h}=gt(this,"not",arguments);return Xt.call(this,t,e,i,s,n,r,h)};function Xt(t,e,i,s,n,r,h){if(e.length){const l=this;return Promise.all(e).then(function(o){t=[];for(let c=0,f;c<o.length;c++)(f=o[c]).length&&(t[c]=f);return Xt.call(l,t,[],i,s,n,r,h)})}if(t.length&&this.result.length)this.result=Ae.call(this,t,i,s,r);else if(r)return this.resolve(i,s,n);return r?n?H.call(this.index,this.result):this.result:this}function Ae(t,e,i,s){const n=[];t=new Set(t.flat().flat());for(let r=0,h,l=0;r<this.result.length;r++)if(h=this.result[r]){for(let o=0,c;o<h.length;o++)if(c=h[o],!t.has(c)){if(i)i--;else if(s){if(n.push(c),n.length===e)return n}else if(n[r]||(n[r]=[]),n[r].push(c),++l===e)return n}}return n}function A(t){if(!this||this.constructor!==A)return new A(t);if(t&&t.index)return t.resolve=!1,this.index=t.index,this.h=t.boost||0,this.result=t.index.search(t).result,this;this.index=null,this.result=t||[],this.h=0}A.prototype.limit=function(t){if(this.result.length){const e=[];for(let i=0,s;i<this.result.length;i++)if(s=this.result[i])if(s.length<=t){if(e[i]=s,t-=s.length,!t)break}else{e[i]=s.slice(0,t);break}this.result=e}return this},A.prototype.offset=function(t){if(this.result.length){const e=[];for(let i=0,s;i<this.result.length;i++)(s=this.result[i])&&(s.length<=t?t-=s.length:(e[i]=s.slice(t),t=0));this.result=e}return this},A.prototype.boost=function(t){return this.h+=t,this},A.prototype.resolve=function(t,e,i){const s=this.result,n=this.index;return this.result=this.index=null,s.length?(typeof t=="object"&&(i=t.enrich,e=t.offset,t=t.limit),zt.call(n,s,t||100,e,i)):s};function Ot(t,e,i,s,n){let r,h,l;typeof n=="string"?(r=n,n=""):r=n.template,h=r.indexOf("$1"),l=r.substring(h+2),h=r.substring(0,h);let o=n&&n.boundary,c=!n||n.clip!==!1,f=n&&n.merge&&l&&h&&new RegExp(l+" "+h,"g");n=n&&n.ellipsis;var u=0;if(typeof n=="object"){var p=n.template;u=p.length-2,n=n.pattern}typeof n!="string"&&(n=n===!1?"":"..."),u&&(n=p.replace("$1",n)),p=n.length-u;let g,d;typeof o=="object"&&(g=o.before,g===0&&(g=-1),d=o.after,d===0&&(d=-1),o=o.total||9e5),u=new Map;for(let Ct=0,X,fe,ct;Ct<e.length;Ct++){let ft;if(s)ft=e,ct=s;else{var m=e[Ct];if(ct=m.field,!ct)continue;ft=m.result}fe=i.get(ct),X=fe.encoder,m=u.get(X),typeof m!="string"&&(m=X.encode(t),u.set(X,m));for(let yt=0;yt<ft.length;yt++){var a=ft[yt].doc;if(!a||(a=it(a,ct),!a))continue;var x=a.trim().split(/\s+/);if(!x.length)continue;a="";var y=[];let xt=[];for(var B=-1,j=-1,b=0,k=0;k<x.length;k++){var _=x[k],z=X.encode(_);z=1<z.length?z.join(" "):z[0];let v;if(z&&_){for(var O=_.length,S=(X.split?_.replace(X.split,""):_).length-z.length,R="",U=0,Q=0;Q<m.length;Q++){var q=m[Q];if(q){var C=q.length;C+=S,U&&C<=U||(q=z.indexOf(q),-1<q&&(R=(q?_.substring(0,q):"")+h+_.substring(q,q+C)+l+(q+C<O?_.substring(q+C):""),U=C,v=!0))}}R&&(o&&(0>B&&(B=a.length+(a?1:0)),j=a.length+(a?1:0)+R.length,b+=O,xt.push(y.length),y.push({match:R})),a+=(a?" ":"")+R)}if(!v)_=x[k],a+=(a?" ":"")+_,o&&y.push({text:_});else if(o&&b>=o)break}if(b=xt.length*(r.length-2),g||d||o&&a.length-b>o)if(b=o+b-2*p,k=j-B,0<g&&(k+=g),0<d&&(k+=d),k<=b)x=g?B-(0<g?g:0):B-((b-k)/2|0),y=d?j+(0<d?d:0):x+b,c||(0<x&&a.charAt(x)!==" "&&a.charAt(x-1)!==" "&&(x=a.indexOf(" ",x),0>x&&(x=0)),y<a.length&&a.charAt(y-1)!==" "&&a.charAt(y)!==" "&&(y=a.lastIndexOf(" ",y),y<j?y=j:++y)),a=(x?n:"")+a.substring(x,y)+(y<a.length?n:"");else{for(j=[],B={},b={},k={},_={},z={},R=S=O=0,Q=U=1;;){var K=void 0;for(let v=0,D;v<xt.length;v++){if(D=xt[v],R)if(S!==R){if(k[v+1])continue;if(D+=R,B[D]){O-=p,b[v+1]=1,k[v+1]=1;continue}if(D>=y.length-1){if(D>=y.length){k[v+1]=1,D>=x.length&&(b[v+1]=1);continue}O-=p}if(a=y[D].text,C=d&&z[v])if(0<C){if(a.length>C)if(k[v+1]=1,c)a=a.substring(0,C);else continue;(C-=a.length)||(C=-1),z[v]=C}else{k[v+1]=1;continue}if(O+a.length+1<=o)a=" "+a,j[v]+=a;else if(c)K=o-O-1,0<K&&(a=" "+a.substring(0,K),j[v]+=a),k[v+1]=1;else{k[v+1]=1;continue}}else{if(k[v])continue;if(D-=S,B[D]){O-=p,k[v]=1,b[v]=1;continue}if(0>=D){if(0>D){k[v]=1,b[v]=1;continue}O-=p}if(a=y[D].text,C=g&&_[v])if(0<C){if(a.length>C)if(k[v]=1,c)a=a.substring(a.length-C);else continue;(C-=a.length)||(C=-1),_[v]=C}else{k[v]=1;continue}if(O+a.length+1<=o)a+=" ",j[v]=a+j[v];else if(c)K=a.length+1-(o-O),0<=K&&K<a.length&&(a=a.substring(K)+" ",j[v]=a+j[v]),k[v]=1;else{k[v]=1;continue}}else{a=y[D].match,g&&(_[v]=g),d&&(z[v]=d),v&&O++;let ue;if(D?!v&&p&&(O+=p):(b[v]=1,k[v]=1),D>=x.length-1||D<y.length-1&&y[D+1].match?ue=1:p&&(O+=p),O-=r.length-2,!v||O+a.length<=o)j[v]=a;else{K=U=Q=b[v]=0;break}ue&&(b[v+1]=1,k[v+1]=1)}O+=a.length,K=B[D]=1}if(K)S===R?R++:S++;else{if(S===R?U=0:Q=0,!U&&!Q)break;U?(S++,R=S):R++}}a="";for(let v=0,D;v<j.length;v++)D=(v&&b[v]?" ":(v&&!n?" ":"")+n)+j[v],a+=D;n&&!b[j.length]&&(a+=n)}f&&(a=a.replace(f," ")),ft[yt].highlight=a}if(s)break}return e}tt.prototype.search=function(t,e,i,s){i||(!e&&et(t)?(i=t,t=""):et(e)&&(i=e,e=0));let n=[];var r=[];let h,l,o,c,f=0;var u=!0;let p;if(i){i.constructor===Array&&(i={index:i}),t=i.query||t,h=i.pluck,l=i.merge,o=h||i.field||(o=i.index)&&(o.index?null:o),c=this.tag&&i.tag;var g=i.suggest;u=i.resolve!==!1,u||h||!(o=o||this.field)||($(o)?h=o:(o.constructor===Array&&o.length===1&&(o=o[0]),h=o.field||o.index));var d=(p=u&&this.store&&i.highlight)||u&&this.store&&i.enrich;e=i.limit||e;var m=i.offset||0;if(e||(e=100),c&&(!this.db||!s)){c.constructor!==Array&&(c=[c]);var a=[];for(let j=0,b;j<c.length;j++)if(b=c[j],b.field&&b.tag){var x=b.tag;if(x.constructor===Array)for(var y=0;y<x.length;y++)a.push(b.field,x[y]);else a.push(b.field,x)}else{x=Object.keys(b);for(let k=0,_,z;k<x.length;k++)if(_=x[k],z=b[_],z.constructor===Array)for(y=0;y<z.length;y++)a.push(_,z[y]);else a.push(_,z)}if(c=a,!t){if(u=[],a.length)for(r=0;r<a.length;r+=2){if(this.db){if(g=this.index.get(a[r]),!g)continue;u.push(g=g.db.tag(a[r+1],e,m,d))}else g=Pe.call(this,a[r],a[r+1],e,m,d);n.push({field:a[r],tag:a[r+1],result:g})}return u.length?Promise.all(u).then(function(j){for(let b=0;b<j.length;b++)n[b].result=j[b];return n}):n}}o&&o.constructor!==Array&&(o=[o])}o||(o=this.field),a=!s&&(this.worker||this.db)&&[];let B;for(let j=0,b,k,_;j<o.length;j++){if(k=o[j],this.db&&this.tag&&!this.F[j])continue;let z;if($(k)||(z=k,k=z.field,t=z.query||t,e=z.limit||e,m=z.offset||m,g=z.suggest||g,p=(d=this.store&&(z.enrich||d))&&(i.highlight||p)),s)b=s[j];else if(x=z||i,y=this.index.get(k),c&&(this.db&&(x.tag=c,B=y.db.support_tag_search,x.field=o),B||(x.enrich=!1)),a){a[j]=y.search(t,e,x),x&&d&&(x.enrich=d);continue}else b=y.search(t,e,x),x&&d&&(x.enrich=d);if(_=b&&(u?b.length:b.result.length),c&&_){if(x=[],y=0,this.db&&s){if(!B)for(let O=o.length;O<s.length;O++){let S=s[O];if(S&&S.length)y++,x.push(S);else if(!g)return u?n:new A(n)}}else for(let O=0,S,R;O<c.length;O+=2){if(S=this.tag.get(c[O]),!S){if(g)continue;return u?n:new A(n)}if(R=(S=S&&S.get(c[O+1]))&&S.length)y++,x.push(S);else if(!g)return u?n:new A(n)}if(y){if(b=ze(b,x,u),_=b.length,!_&&!g)return u?b:new A(b);y--}}if(_)r[f]=k,n.push(b),f++;else if(o.length===1)return u?n:new A(n)}if(a){if(this.db&&c&&c.length&&!B)for(d=0;d<c.length;d+=2){if(r=this.index.get(c[d]),!r){if(g)continue;return u?n:new A(n)}a.push(r.db.tag(c[d+1],e,m,!1))}const j=this;return Promise.all(a).then(function(b){return b.length?j.search(t,e,i,b):b})}if(!f)return u?n:new A(n);if(h&&(!d||!this.store))return n[0];for(a=[],m=0;m<r.length;m++){if(g=n[m],d&&g.length&&typeof g[0].doc>"u"&&(this.db?a.push(g=this.index.get(this.field[0]).db.enrich(g)):g=H.call(this,g)),h)return u?p?Ot(t,g,this.index,h,p):g:new A(g);n[m]={field:r[m],result:g}}if(d&&this.db&&a.length){const j=this;return Promise.all(a).then(function(b){for(let k=0;k<b.length;k++)n[k].result=b[k];return l?Yt(n):p?Ot(t,n,j.index,h,p):n})}return l?Yt(n):p?Ot(t,n,this.index,h,p):n};function Yt(t){const e=[],i=M();for(let s=0,n,r;s<t.length;s++){n=t[s],r=n.result;for(let h=0,l,o,c;h<r.length;h++)o=r[h],typeof o!="object"&&(o={id:o}),l=o.id,(c=i[l])?c.push(n.field):(o.field=i[l]=[n.field],e.push(o))}return e}function Pe(t,e,i,s,n){if(t=this.tag.get(t),!t)return[];if((e=(t=t&&t.get(e))&&t.length-s)&&0<e)return(e>i||s)&&(t=t.slice(s,s+i)),n&&(t=H.call(this,t)),t}function H(t){if(!this||!this.store)return t;const e=Array(t.length);for(let i=0,s;i<t.length;i++)s=t[i],e[i]={id:s,doc:this.store.get(s)};return e}function tt(t){if(!this||this.constructor!==tt)return new tt(t);const e=t.document||t.doc||t;let i,s;if(this.F=[],this.field=[],this.J=[],this.key=(i=e.key||e.id)&&pt(i,this.J)||"id",(s=t.keystore||0)&&(this.keystore=s),this.fastupdate=!!t.fastupdate,this.reg=!this.fastupdate||t.worker||t.db?s?new N(s):new Set:s?new L(s):new Map,this.C=(i=e.store||null)&&i&&i!==!0&&[],this.store=i&&(s?new L(s):new Map),this.cache=(i=t.cache||null)&&new F(i),t.cache=!1,this.worker=t.worker||!1,this.priority=t.priority||4,this.index=Se.call(this,t,e),this.tag=null,(i=e.tag)&&(typeof i=="string"&&(i=[i]),i.length)){this.tag=new Map,this.D=[],this.R=[];for(let n=0,r,h;n<i.length;n++){if(r=i[n],h=r.field||r,!h)throw Error("The tag field from the document descriptor is undefined.");r.custom?this.D[n]=r.custom:(this.D[n]=pt(h,this.J),r.filter&&(typeof this.D[n]=="string"&&(this.D[n]=new String(this.D[n])),this.D[n].I=r.filter)),this.R[n]=h,this.tag.set(h,new Map)}}if(this.worker){this.fastupdate=!1;const n=[];for(const r of this.index.values())r.then&&n.push(r);if(n.length){const r=this;return Promise.all(n).then(function(h){const l=new Map;let o=0;for(const f of r.index.entries()){const u=f[0];var c=f[1];if(c.then){c=n[o].encoder||{};let p=l.get(c);p||(p=c.encode?c:new nt(c),l.set(c,p)),c=h[o],c.encoder=p,r.index.set(u,c),o++}}return r})}}else t.db&&(this.fastupdate=!1,this.mount(t.db))}w=tt.prototype,w.mount=function(t){let e=this.field;if(this.tag)for(let r=0,h;r<this.R.length;r++){h=this.R[r];var i=void 0;this.index.set(h,i=new J({},this.reg)),e===this.field&&(e=e.slice(0)),e.push(h),i.tag=this.tag.get(h)}i=[];const s={db:t.db,type:t.type,fastupdate:t.fastupdate};for(let r=0,h,l;r<e.length;r++){s.field=l=e[r],h=this.index.get(l);const o=new t.constructor(t.id,s);o.id=t.id,i[r]=o.mount(h),h.document=!0,r?h.bypass=!0:h.store=this.store}const n=this;return this.db=Promise.all(i).then(function(){n.db=!0})},w.commit=async function(t,e){const i=[];for(const s of this.index.values())i.push(s.commit(t,e));await Promise.all(i),this.reg.clear()},w.destroy=function(){const t=[];for(const e of this.index.values())t.push(e.destroy());return Promise.all(t)};function Se(t,e){const i=new Map;let s=e.index||e.field||e;$(s)&&(s=[s]);for(let n=0,r,h;n<s.length;n++){if(r=s[n],$(r)||(h=r,r=r.field),h=et(h)?Object.assign({},t,h):t,this.worker){const l=new ht(h);l.encoder=h.encoder,i.set(r,l)}this.worker||i.set(r,new J(h,this.reg)),h.custom?this.F[n]=h.custom:(this.F[n]=pt(r,this.J),h.filter&&(typeof this.F[n]=="string"&&(this.F[n]=new String(this.F[n])),this.F[n].I=h.filter)),this.field[n]=r}if(this.C){t=e.store,$(t)&&(t=[t]);for(let n=0,r,h;n<t.length;n++)r=t[n],h=r.field||r,r.custom?(this.C[n]=r.custom,r.custom.V=h):(this.C[n]=pt(h,this.J),r.filter&&(typeof this.C[n]=="string"&&(this.C[n]=new String(this.C[n])),this.C[n].I=r.filter))}return i}function pt(t,e){const i=t.split(":");let s=0;for(let n=0;n<i.length;n++)t=i[n],t[t.length-1]==="]"&&(t=t.substring(0,t.length-2))&&(e[s]=!0),t&&(i[s++]=t);return s<i.length&&(i.length=s),1<s?i:i[0]}w.append=function(t,e){return this.add(t,e,!0)},w.update=function(t,e){return this.remove(t).add(t,e)},w.remove=function(t){et(t)&&(t=it(t,this.key));for(var e of this.index.values())e.remove(t,!0);if(this.reg.has(t)){if(this.tag&&!this.fastupdate)for(let i of this.tag.values())for(let s of i){e=s[0];const n=s[1],r=n.indexOf(t);-1<r&&(1<n.length?n.splice(r,1):i.delete(e))}this.store&&this.store.delete(t),this.reg.delete(t)}return this.cache&&this.cache.remove(t),this},w.clear=function(){const t=[];for(const e of this.index.values()){const i=e.clear();i.then&&t.push(i)}if(this.tag)for(const e of this.tag.values())e.clear();return this.store&&this.store.clear(),this.cache&&this.cache.clear(),t.length?Promise.all(t):this},w.contain=function(t){return this.db?this.index.get(this.field[0]).db.has(t):this.reg.has(t)},w.cleanup=function(){for(const t of this.index.values())t.cleanup();return this},w.get=function(t){return this.db?this.index.get(this.field[0]).db.enrich(t).then(function(e){return e[0]&&e[0].doc||null}):this.store.get(t)||null},w.set=function(t,e){return typeof t=="object"&&(e=t,t=it(e,this.key)),this.store.set(t,e),this},w.searchCache=It,w.export=function(t,e,i=0,s=0){if(i<this.field.length){const h=this.field[i];if((e=this.index.get(h).export(t,h,i,s=1))&&e.then){const l=this;return e.then(function(){return l.export(t,h,i+1)})}return this.export(t,h,i+1)}let n,r;switch(s){case 0:n="reg",r=Kt(this.reg),e=null;break;case 1:n="tag",r=this.tag&&qt(this.tag,this.reg.size),e=null;break;case 2:n="doc",r=this.store&&kt(this.store),e=null;break;default:return}return at.call(this,t,e,n,r,i,s)},w.import=function(t,e){var i=t.split(".");i[i.length-1]==="json"&&i.pop();const s=2<i.length?i[0]:"";if(i=2<i.length?i[2]:i[1],this.worker&&s)return this.index.get(s).import(t);if(e){if(typeof e=="string"&&(e=JSON.parse(e)),s)return this.index.get(s).import(i,e);switch(i){case"reg":this.fastupdate=!1,this.reg=Gt(e,this.reg);for(let n=0,r;n<this.field.length;n++)r=this.index.get(this.field[n]),r.fastupdate=!1,r.reg=this.reg;if(this.worker){e=[];for(const n of this.index.values())e.push(n.import(t));return Promise.all(e)}break;case"tag":this.tag=Lt(e,this.tag);break;case"doc":this.store=jt(e,this.store)}}},bt(tt.prototype);function It(t,e,i){const s=(typeof t=="object"?""+t.query:t).toLowerCase();this.cache||(this.cache=new F);let n=this.cache.get(s);if(!n){if(n=this.search(t,e,i),n.then){const r=this;n.then(function(h){return r.cache.set(s,h),h})}this.cache.set(s,n)}return n}function F(t){this.limit=t&&t!==!0?t:1e3,this.cache=new Map,this.h=""}F.prototype.set=function(t,e){this.cache.set(this.h=t,e),this.cache.size>this.limit&&this.cache.delete(this.cache.keys().next().value)},F.prototype.get=function(t){const e=this.cache.get(t);return e&&this.h!==t&&(this.cache.delete(t),this.cache.set(this.h=t,e)),e},F.prototype.remove=function(t){for(const e of this.cache){const i=e[0];e[1].includes(t)&&this.cache.delete(i)}},F.prototype.clear=function(){this.cache.clear(),this.h=""};const te={normalize:!1,numeric:!1,dedupe:!1},dt={},At=new Map([["b","p"],["v","f"],["w","f"],["z","s"],["x","s"],["d","t"],["n","m"],["c","k"],["g","k"],["j","k"],["q","k"],["i","e"],["y","e"],["u","o"]]),ee=new Map([["ae","a"],["oe","o"],["sh","s"],["kh","k"],["th","t"],["ph","f"],["pf","f"]]),ie=[/([^aeo])h(.)/g,"$1$2",/([aeo])h([^aeo]|$)/g,"$1$2",/(.)\1+/g,"$1"],ne={a:"",e:"",i:"",o:"",u:"",y:"",b:1,f:1,p:1,v:1,c:2,g:2,j:2,k:2,q:2,s:2,x:2,z:2,ß:2,d:3,t:3,l:4,m:5,n:5,r:6};var De={Exact:te,Default:dt,Normalize:dt,LatinBalance:{mapper:At},LatinAdvanced:{mapper:At,matcher:ee,replacer:ie},LatinExtra:{mapper:At,replacer:ie.concat([/(?!^)[aeo]/g,""]),matcher:ee},LatinSoundex:{dedupe:!1,include:{letter:!0},finalize:function(t){for(let i=0;i<t.length;i++){var e=t[i];let s=e.charAt(0),n=ne[s];for(let r=1,h;r<e.length&&(h=e.charAt(r),h==="h"||h==="w"||!(h=ne[h])||h===n||(s+=h,n=h,s.length!==4));r++);t[i]=s}}},CJK:{split:""},LatinExact:te,LatinDefault:dt,LatinSimple:dt};J.prototype.remove=function(t,e){const i=this.reg.size&&(this.fastupdate?this.reg.get(t):this.reg.has(t));if(i){if(this.fastupdate){for(let s=0,n;s<i.length;s++)if(n=i[s])if(2>n.length)n.pop();else{const r=n.indexOf(t);r===i.length-1?n.pop():n.splice(r,1)}}else ot(this.map,t),this.depth&&ot(this.ctx,t);e||this.reg.delete(t)}return this.db&&(this.commit_task.push({del:t}),this.T&&oe(this)),this.cache&&this.cache.remove(t),this};function ot(t,e){let i=0;var s=typeof e>"u";if(t.constructor===Array){for(let n=0,r,h;n<t.length;n++)if((r=t[n])&&r.length)if(s)i++;else if(h=r.indexOf(e),0<=h){1<r.length?(r.splice(h,1),i++):delete t[n];break}else i++}else for(let n of t.entries()){s=n[0];const r=ot(n[1],e);r?i+=r:t.delete(s)}return i}const Be={memory:{resolution:1},performance:{resolution:3,fastupdate:!0,context:{depth:1,resolution:1}},match:{tokenize:"forward"},score:{resolution:9,context:{depth:2,resolution:3}}};J.prototype.add=function(t,e,i,s){if(e&&(t||t===0)){if(!s&&!i&&this.reg.has(t))return this.update(t,e);s=this.depth,e=this.encoder.encode(e,!s);const c=e.length;if(c){const f=M(),u=M(),p=this.resolution;for(let g=0;g<c;g++){let d=e[this.rtl?c-1-g:g];var n=d.length;if(n&&(s||!u[d])){var r=this.score?this.score(e,d,g,null,0):mt(p,c,g),h="";switch(this.tokenize){case"full":if(2<n){for(let m=0,a;m<n;m++)for(r=n;r>m;r--){h=d.substring(m,r),a=this.rtl?n-1-m:m;var l=this.score?this.score(e,d,g,h,a):mt(p,c,g,n,a);lt(this,u,h,l,t,i)}break}case"bidirectional":case"reverse":if(1<n){for(l=n-1;0<l;l--){h=d[this.rtl?n-1-l:l]+h;var o=this.score?this.score(e,d,g,h,l):mt(p,c,g,n,l);lt(this,u,h,o,t,i)}h=""}case"forward":if(1<n){for(l=0;l<n;l++)h+=d[this.rtl?n-1-l:l],lt(this,u,h,r,t,i);break}default:if(lt(this,u,d,r,t,i),s&&1<c&&g<c-1){for(n=M(),h=this.U,r=d,l=Math.min(s+1,this.rtl?g+1:c-g),n[r]=1,o=1;o<l;o++)if((d=e[this.rtl?c-1-g-o:g+o])&&!n[d]){n[d]=1;const m=this.score?this.score(e,r,g,d,o-1):mt(h+(c/2>h?0:1),c,g,l-1,o-1),a=this.bidirectional&&d>r;lt(this,f,a?r:d,m,t,i,a?d:r)}}}}}this.fastupdate||this.reg.add(t)}else e=""}return this.db&&(e||this.commit_task.push({del:t}),this.T&&oe(this)),this};function lt(t,e,i,s,n,r,h){let l=h?t.ctx:t.map,o;if((!e[i]||h&&!(o=e[i])[h])&&(h?(e=o||(e[i]=M()),e[h]=1,(o=l.get(h))?l=o:l.set(h,l=new Map)):e[i]=1,(o=l.get(i))?l=o:l.set(i,l=o=[]),l=l[s]||(l[s]=[]),!r||!l.includes(n))){if(l.length===2**31-1){if(e=new V(l),t.fastupdate)for(let c of t.reg.values())c.includes(l)&&(c[c.indexOf(l)]=e);o[s]=l=e}l.push(n),t.fastupdate&&((s=t.reg.get(n))?s.push(l):t.reg.set(n,[l]))}}function mt(t,e,i,s,n){return i&&1<t?e+(s||0)<=t?i+(n||0):(t-1)/(e+(s||0))*(i+(n||0))+1|0:0}J.prototype.search=function(t,e,i){i||(e||typeof t!="object"?typeof e=="object"&&(i=e,e=0):(i=t,t=""));let s=[],n,r,h,l=0,o,c,f,u,p;i?(t=i.query||t,e=i.limit||e,l=i.offset||0,r=i.context,h=i.suggest,p=(o=i.resolve!==!1)&&i.enrich,f=i.boost,u=i.resolution,c=this.db&&i.tag):o=this.resolve,r=this.depth&&r!==!1;let g=this.encoder.encode(t,!r);if(n=g.length,e=e||(o?100:0),n===1)return re.call(this,g[0],"",e,l,o,p,c);if(n===2&&r&&!h)return re.call(this,g[1],g[0],e,l,o,p,c);let d=M(),m=0,a;if(r&&(a=g[0],m=1),u||u===0||(u=a?this.U:this.resolution),this.db){if(this.db.search&&(t=this.db.search(this,g,e,l,h,o,p,c),t!==!1))return t;const x=this;return async function(){for(let y,B;m<n;m++){if((B=g[m])&&!d[B]){if(d[B]=1,y=await Pt(x,B,a,0,0,!1,!1),y=he(y,s,h,u)){s=y;break}a&&(h&&y&&s.length||(a=B))}h&&a&&m===n-1&&!s.length&&(u=x.resolution,a="",m=-1,d=M())}return se(s,u,e,l,h,f,o)}()}for(let x,y;m<n;m++){if((y=g[m])&&!d[y]){if(d[y]=1,x=Pt(this,y,a,0,0,!1,!1),x=he(x,s,h,u)){s=x;break}a&&(h&&x&&s.length||(a=y))}h&&a&&m===n-1&&!s.length&&(u=this.resolution,a="",m=-1,d=M())}return se(s,u,e,l,h,f,o)};function se(t,e,i,s,n,r,h){let l=t.length,o=t;if(1<l)o=Wt(t,e,i,s,n,r,h);else if(l===1)return h?zt.call(null,t[0],i,s):new A(t[0]);return h?o:new A(o)}function re(t,e,i,s,n,r,h){return t=Pt(this,t,e,i,s,n,r,h),this.db?t.then(function(l){return n?l||[]:new A(l)}):t&&t.length?n?zt.call(this,t,i,s):new A(t):n?[]:new A}function he(t,e,i,s){let n=[];if(t&&t.length){if(t.length<=s){e.push(t);return}for(let r=0,h;r<s;r++)(h=t[r])&&(n[r]=h);if(n.length){e.push(n);return}}if(!i)return n}function Pt(t,e,i,s,n,r,h,l){let o;return i&&(o=t.bidirectional&&e>i)&&(o=i,i=e,e=o),t.db?t.db.get(e,i,s,n,r,h,l):(t=i?(t=t.ctx.get(i))&&t.get(e):t.map.get(e),t)}function J(t,e){if(!this||this.constructor!==J)return new J(t);if(t){var i=$(t)?t:t.preset;i&&(t=Object.assign({},Be[i],t))}else t={};i=t.context;const s=i===!0?{depth:1}:i||{},n=$(t.encoder)?De[t.encoder]:t.encode||t.encoder||{};this.encoder=n.encode?n:typeof n=="object"?new nt(n):{encode:n},this.resolution=t.resolution||9,this.tokenize=i=(i=t.tokenize)&&i!=="default"&&i!=="exact"&&i||"strict",this.depth=i==="strict"&&s.depth||0,this.bidirectional=s.bidirectional!==!1,this.fastupdate=!!t.fastupdate,this.score=t.score||null,(i=t.keystore||0)&&(this.keystore=i),this.map=i?new L(i):new Map,this.ctx=i?new L(i):new Map,this.reg=e||(this.fastupdate?i?new L(i):new Map:i?new N(i):new Set),this.U=s.resolution||3,this.rtl=n.rtl||t.rtl||!1,this.cache=(i=t.cache||null)&&new F(i),this.resolve=t.resolve!==!1,(i=t.db)&&(this.db=this.mount(i)),this.T=t.commit!==!1,this.commit_task=[],this.commit_timer=null,this.priority=t.priority||4}w=J.prototype,w.mount=function(t){return this.commit_timer&&(clearTimeout(this.commit_timer),this.commit_timer=null),t.mount(this)},w.commit=function(t,e){return this.commit_timer&&(clearTimeout(this.commit_timer),this.commit_timer=null),this.db.commit(this,t,e)},w.destroy=function(){return this.commit_timer&&(clearTimeout(this.commit_timer),this.commit_timer=null),this.db.destroy()};function oe(t){t.commit_timer||(t.commit_timer=setTimeout(function(){t.commit_timer=null,t.db.commit(t,void 0,void 0)},1))}w.clear=function(){return this.map.clear(),this.ctx.clear(),this.reg.clear(),this.cache&&this.cache.clear(),this.db&&(this.commit_timer&&clearTimeout(this.commit_timer),this.commit_timer=null,this.commit_task=[{clear:!0}]),this},w.append=function(t,e){return this.add(t,e,!0)},w.contain=function(t){return this.db?this.db.has(t):this.reg.has(t)},w.update=function(t,e){const i=this,s=this.remove(t);return s&&s.then?s.then(()=>i.add(t,e)):this.add(t,e)},w.cleanup=function(){return this.fastupdate?(ot(this.map),this.depth&&ot(this.ctx),this):this},w.searchCache=It,w.export=function(t,e,i=0,s=0){let n,r;switch(s){case 0:n="reg",r=Kt(this.reg);break;case 1:n="cfg",r=null;break;case 2:n="map",r=kt(this.map,this.reg.size);break;case 3:n="ctx",r=qt(this.ctx,this.reg.size);break;default:return}return at.call(this,t,e,n,r,i,s)},w.import=function(t,e){if(e)switch(typeof e=="string"&&(e=JSON.parse(e)),t=t.split("."),t[t.length-1]==="json"&&t.pop(),t.length===3&&t.shift(),t=1<t.length?t[1]:t[0],t){case"reg":this.fastupdate=!1,this.reg=Gt(e,this.reg);break;case"map":this.map=jt(e,this.map);break;case"ctx":this.ctx=Lt(e,this.ctx)}},w.serialize=function(t=!0){let e="",i="",s="";if(this.reg.size){let r;for(var n of this.reg.keys())r||(r=typeof n),e+=(e?",":"")+(r==="string"?'"'+n+'"':n);e="index.reg=new Set(["+e+"]);",i=Ht(this.map,r),i="index.map=new Map(["+i+"]);";for(const h of this.ctx.entries()){n=h[0];let l=Ht(h[1],r);l="new Map(["+l+"])",l='["'+n+'",'+l+"]",s+=(s?",":"")+l}s="index.ctx=new Map(["+s+"]);"}return t?"function inject(index){"+e+i+s+"}":e+i+s},bt(J.prototype);const le=typeof window<"u"&&(window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB),wt=["map","ctx","tag","reg","cfg"],Z=M();function St(t,e={}){if(!this||this.constructor!==St)return new St(t,e);typeof t=="object"&&(e=t,t=t.name),t||console.info("Default storage space was used, because a name was not passed."),this.id="flexsearch"+(t?":"+t.toLowerCase().replace(/[^a-z0-9_\-]/g,""):""),this.field=e.field?e.field.toLowerCase().replace(/[^a-z0-9_\-]/g,""):"",this.type=e.type,this.fastupdate=this.support_tag_search=!1,this.db=null,this.h={}}w=St.prototype,w.mount=function(t){return t.index?t.mount(this):(t.db=this,this.open())},w.open=function(){if(this.db)return this.db;let t=this;navigator.storage&&navigator.storage.persist(),Z[t.id]||(Z[t.id]=[]),Z[t.id].push(t.field);const e=le.open(t.id,1);return e.onupgradeneeded=function(){const i=t.db=this.result;for(let s=0,n;s<wt.length;s++){n=wt[s];for(let r=0,h;r<Z[t.id].length;r++)h=Z[t.id][r],i.objectStoreNames.contains(n+(n!=="reg"&&h?":"+h:""))||i.createObjectStore(n+(n!=="reg"&&h?":"+h:""))}},t.db=T(e,function(i){t.db=i,t.db.onversionchange=function(){t.close()}})},w.close=function(){this.db&&this.db.close(),this.db=null},w.destroy=function(){const t=le.deleteDatabase(this.id);return T(t)},w.clear=function(){const t=[];for(let i=0,s;i<wt.length;i++){s=wt[i];for(let n=0,r;n<Z[this.id].length;n++)r=Z[this.id][n],t.push(s+(s!=="reg"&&r?":"+r:""))}const e=this.db.transaction(t,"readwrite");for(let i=0;i<t.length;i++)e.objectStore(t[i]).clear();return T(e)},w.get=function(t,e,i=0,s=0,n=!0,r=!1){t=this.db.transaction((e?"ctx":"map")+(this.field?":"+this.field:""),"readonly").objectStore((e?"ctx":"map")+(this.field?":"+this.field:"")).get(e?e+":"+t:t);const h=this;return T(t).then(function(l){let o=[];if(!l||!l.length)return o;if(n){if(!i&&!s&&l.length===1)return l[0];for(let c=0,f;c<l.length;c++)if((f=l[c])&&f.length){if(s>=f.length){s-=f.length;continue}const u=i?s+Math.min(f.length-s,i):f.length;for(let p=s;p<u;p++)o.push(f[p]);if(s=0,o.length===i)break}return r?h.enrich(o):o}return l})},w.tag=function(t,e=0,i=0,s=!1){t=this.db.transaction("tag"+(this.field?":"+this.field:""),"readonly").objectStore("tag"+(this.field?":"+this.field:"")).get(t);const n=this;return T(t).then(function(r){return!r||!r.length||i>=r.length?[]:!e&&!i?r:(r=r.slice(i,i+e),s?n.enrich(r):r)})},w.enrich=function(t){typeof t!="object"&&(t=[t]);const e=this.db.transaction("reg","readonly").objectStore("reg"),i=[];for(let s=0;s<t.length;s++)i[s]=T(e.get(t[s]));return Promise.all(i).then(function(s){for(let n=0;n<s.length;n++)s[n]={id:t[n],doc:s[n]?JSON.parse(s[n]):null};return s})},w.has=function(t){return t=this.db.transaction("reg","readonly").objectStore("reg").getKey(t),T(t).then(function(e){return!!e})},w.search=null,w.info=function(){},w.transaction=function(t,e,i){t+=t!=="reg"&&this.field?":"+this.field:"";let s=this.h[t+":"+e];if(s)return i.call(this,s);let n=this.db.transaction(t,e);this.h[t+":"+e]=s=n.objectStore(t);const r=i.call(this,s);return this.h[t+":"+e]=null,T(n).finally(function(){return n=s=null,r})},w.commit=async function(t,e,i){if(e)await this.clear(),t.commit_task=[];else{let s=t.commit_task;t.commit_task=[];for(let n=0,r;n<s.length;n++)if(r=s[n],r.clear){await this.clear(),e=!0;break}else s[n]=r.del;e||(i||(s=s.concat(we(t.reg))),s.length&&await this.remove(s))}t.reg.size&&(await this.transaction("map","readwrite",function(s){for(const n of t.map){const r=n[0],h=n[1];h.length&&(e?s.put(h,r):s.get(r).onsuccess=function(){let l=this.result;var o;if(l&&l.length){const c=Math.max(l.length,h.length);for(let f=0,u,p;f<c;f++)if((p=h[f])&&p.length){if((u=l[f])&&u.length)for(o=0;o<p.length;o++)u.push(p[o]);else l[f]=p;o=1}}else l=h,o=1;o&&s.put(l,r)})}}),await this.transaction("ctx","readwrite",function(s){for(const n of t.ctx){const r=n[0],h=n[1];for(const l of h){const o=l[0],c=l[1];c.length&&(e?s.put(c,r+":"+o):s.get(r+":"+o).onsuccess=function(){let f=this.result;var u;if(f&&f.length){const p=Math.max(f.length,c.length);for(let g=0,d,m;g<p;g++)if((m=c[g])&&m.length){if((d=f[g])&&d.length)for(u=0;u<m.length;u++)d.push(m[u]);else f[g]=m;u=1}}else f=c,u=1;u&&s.put(f,r+":"+o)})}}}),t.store?await this.transaction("reg","readwrite",function(s){for(const n of t.store){const r=n[0],h=n[1];s.put(typeof h=="object"?JSON.stringify(h):1,r)}}):t.bypass||await this.transaction("reg","readwrite",function(s){for(const n of t.reg.keys())s.put(1,n)}),t.tag&&await this.transaction("tag","readwrite",function(s){for(const n of t.tag){const r=n[0],h=n[1];h.length&&(s.get(r).onsuccess=function(){let l=this.result;l=l&&l.length?l.concat(h):h,s.put(l,r)})}}),t.map.clear(),t.ctx.clear(),t.tag&&t.tag.clear(),t.store&&t.store.clear(),t.document||t.reg.clear())};function Dt(t,e,i){const s=t.value;let n,r=0;for(let h=0,l;h<s.length;h++){if(l=i?s:s[h]){for(let o=0,c,f;o<e.length;o++)if(f=e[o],c=l.indexOf(f),0<=c)if(n=1,1<l.length)l.splice(c,1);else{s[h]=[];break}r+=l.length}if(i)break}r?n&&t.update(s):t.delete(),t.continue()}w.remove=function(t){return typeof t!="object"&&(t=[t]),Promise.all([this.transaction("map","readwrite",function(e){e.openCursor().onsuccess=function(){const i=this.result;i&&Dt(i,t)}}),this.transaction("ctx","readwrite",function(e){e.openCursor().onsuccess=function(){const i=this.result;i&&Dt(i,t)}}),this.transaction("tag","readwrite",function(e){e.openCursor().onsuccess=function(){const i=this.result;i&&Dt(i,t,!0)}}),this.transaction("reg","readwrite",function(e){for(let i=0;i<t.length;i++)e.delete(t[i])})])};function T(t,e){return new Promise((i,s)=>{t.onsuccess=t.oncomplete=function(){e&&e(this.result),e=null,i(this.result)},t.onerror=t.onblocked=s,t=null})}const ce=J;let Bt=new ce;self.onmessage=t=>{switch(t.data.type){case"clear":Bt=new ce,postMessage({identifier:t.data.identifier});break;case"points":for(let i of t.data.points)Bt.add(i.id,i.text);postMessage({identifier:t.data.identifier});break;case"query":let e=Bt.search(t.data.query,{limit:t.data.limit});postMessage({identifier:t.data.identifier,result:e});break}}}()),Rt.exports}me()})();
